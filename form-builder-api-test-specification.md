# シンプルフォーム作成アプリケーション APIテストケース

## 1. 認証 API テストケース

### 1.1 ユーザー登録 (POST /auth/register)

#### 正常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 1.1.1 | 有効なメールアドレスとパスワードでユーザー登録 | 201 Created, ユーザー情報とトークンが返却される |
| 1.1.2 | 最小要件を満たすパスワード（例：8文字以上）での登録 | 201 Created, 登録成功 |

#### 異常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 1.1.3 | 既に登録済みのメールアドレスで登録 | 400 Bad Request, `DUPLICATE_EMAIL` エラー |
| 1.1.4 | 無効なメールアドレス形式で登録 | 400 Bad Request, `INVALID_INPUT` エラー |
| 1.1.5 | パスワードが要件を満たさない（短すぎる等） | 400 Bad Request, `INVALID_INPUT` エラー |
| 1.1.6 | 必須フィールド（メールアドレスかパスワード）が欠けている | 400 Bad Request, `MISSING_REQUIRED_FIELD` エラー |

### 1.2 ログイン (POST /auth/login)

#### 正常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 1.2.1 | 正しいメールアドレスとパスワードでログイン | 200 OK, ユーザー情報とトークンが返却される |

#### 異常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 1.2.2 | 存在しないメールアドレスでログイン | 401 Unauthorized, `INVALID_CREDENTIALS` エラー |
| 1.2.3 | 正しいメールアドレスと間違ったパスワードでログイン | 401 Unauthorized, `INVALID_CREDENTIALS` エラー |
| 1.2.4 | 必須フィールドが欠けている | 400 Bad Request, `MISSING_REQUIRED_FIELD` エラー |
| 1.2.5 | レート制限を超えたログイン試行（連続失敗） | 429 Too Many Requests, `RATE_LIMIT_EXCEEDED` エラー |

### 1.3 パスワードリセットリクエスト (POST /auth/reset-password-request)

#### 正常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 1.3.1 | 登録済みメールアドレスに対するリセットリクエスト | 200 OK, リセットメールが送信される |
| 1.3.2 | 未登録のメールアドレスに対するリセットリクエスト | 200 OK, セキュリティ上の理由で同じレスポンス（メール非送信） |

#### 異常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 1.3.3 | 無効なメールアドレス形式 | 400 Bad Request, `INVALID_INPUT` エラー |
| 1.3.4 | 必須フィールド（メールアドレス）が欠けている | 400 Bad Request, `MISSING_REQUIRED_FIELD` エラー |
| 1.3.5 | レート制限を超えたリクエスト | 429 Too Many Requests, `RATE_LIMIT_EXCEEDED` エラー |

### 1.4 パスワードリセット (POST /auth/reset-password)

#### 正常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 1.4.1 | 有効なトークンと新パスワードでリセット | 200 OK, パスワードが更新される |

#### 異常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 1.4.2 | 無効なトークンでリセット | 400 Bad Request, `INVALID_TOKEN` エラー |
| 1.4.3 | 期限切れトークンでリセット | 400 Bad Request, `TOKEN_EXPIRED` エラー |
| 1.4.4 | 新パスワードが要件を満たさない | 400 Bad Request, `INVALID_INPUT` エラー |
| 1.4.5 | 必須フィールドが欠けている | 400 Bad Request, `MISSING_REQUIRED_FIELD` エラー |

## 2. フォーム管理 API テストケース

### 2.1 フォーム作成 (POST /forms)

#### 正常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 2.1.1 | 最小限の要素（タイトルのみ）でフォーム作成 | 201 Created, フォームIDと共有URLが返却される |
| 2.1.2 | すべてのフィールドタイプを含むフォーム作成 | 201 Created, フォームが正常に作成される |
| 2.1.3 | 選択肢を持つ要素（ラジオボタン、チェックボックス）のフォーム作成 | 201 Created, 選択肢が正常に保存される |

#### 異常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 2.1.4 | 認証なしでフォーム作成 | 401 Unauthorized, `AUTHENTICATION_REQUIRED` エラー |
| 2.1.5 | 無効なトークンでフォーム作成 | 401 Unauthorized, `INVALID_TOKEN` エラー |
| 2.1.6 | タイトルが欠けているフォーム作成 | 400 Bad Request, `MISSING_REQUIRED_FIELD` エラー |
| 2.1.7 | 無効な要素タイプを含むフォーム作成 | 400 Bad Request, `INVALID_INPUT` エラー |
| 2.1.8 | 選択肢が必要な要素に選択肢がない | 400 Bad Request, `INVALID_INPUT` エラー |
| 2.1.9 | レート制限を超えたフォーム作成 | 429 Too Many Requests, `RATE_LIMIT_EXCEEDED` エラー |

### 2.2 フォーム一覧取得 (GET /forms)

#### 正常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 2.2.1 | 認証済みユーザーのフォーム一覧取得 | 200 OK, フォーム一覧が返却される |
| 2.2.2 | フォームがないユーザーの一覧取得 | 200 OK, 空の配列が返却される |
| 2.2.3 | ページネーションパラメータ指定での一覧取得 | 200 OK, 指定されたページのフォームが返却される |
| 2.2.4 | ソート順指定での一覧取得 | 200 OK, 指定された順序でフォームが返却される |

#### 異常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 2.2.5 | 認証なしでフォーム一覧取得 | 401 Unauthorized, `AUTHENTICATION_REQUIRED` エラー |
| 2.2.6 | 無効なトークンでフォーム一覧取得 | 401 Unauthorized, `INVALID_TOKEN` エラー |
| 2.2.7 | 無効なページネーションパラメータ（負の値など） | 400 Bad Request, `INVALID_INPUT` エラー |

### 2.3 フォーム詳細取得 (GET /forms/{formId})

#### 正常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 2.3.1 | 存在するフォームIDでの詳細取得 | 200 OK, フォーム詳細が返却される |

#### 異常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 2.3.2 | 認証なしでフォーム詳細取得 | 401 Unauthorized, `AUTHENTICATION_REQUIRED` エラー |
| 2.3.3 | 存在しないフォームIDでの詳細取得 | 404 Not Found, `FORM_NOT_FOUND` エラー |
| 2.3.4 | 他ユーザーのフォームIDでの詳細取得 | 403 Forbidden, `PERMISSION_DENIED` エラー |

### 2.4 フォーム更新 (PUT /forms/{formId})

#### 正常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 2.4.1 | タイトルと説明の更新 | 200 OK, フォームが更新される |
| 2.4.2 | 既存要素の修正 | 200 OK, 要素が更新される |
| 2.4.3 | 新しい要素の追加 | 200 OK, 要素が追加される |
| 2.4.4 | 要素の削除 | 200 OK, 要素が削除される |
| 2.4.5 | 要素の順序変更 | 200 OK, 順序が更新される |

#### 異常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 2.4.6 | 認証なしでフォーム更新 | 401 Unauthorized, `AUTHENTICATION_REQUIRED` エラー |
| 2.4.7 | 存在しないフォームIDでの更新 | 404 Not Found, `FORM_NOT_FOUND` エラー |
| 2.4.8 | 他ユーザーのフォームIDでの更新 | 403 Forbidden, `PERMISSION_DENIED` エラー |
| 2.4.9 | 無効な要素データでの更新 | 400 Bad Request, `INVALID_INPUT` エラー |
| 2.4.10 | タイトルを空にする更新 | 400 Bad Request, `MISSING_REQUIRED_FIELD` エラー |

### 2.5 フォーム削除 (DELETE /forms/{formId})

#### 正常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 2.5.1 | 存在するフォームIDでの削除 | 200 OK, フォームが削除される |

#### 異常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 2.5.2 | 認証なしでフォーム削除 | 401 Unauthorized, `AUTHENTICATION_REQUIRED` エラー |
| 2.5.3 | 存在しないフォームIDでの削除 | 404 Not Found, `FORM_NOT_FOUND` エラー |
| 2.5.4 | 他ユーザーのフォームIDでの削除 | 403 Forbidden, `PERMISSION_DENIED` エラー |

### 2.6 フォームの状態変更 (PATCH /forms/{formId}/status)

#### 正常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 2.6.1 | アクティブ状態への変更 | 200 OK, ステータスが更新される |
| 2.6.2 | 非アクティブ状態への変更 | 200 OK, ステータスが更新される |

#### 異常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 2.6.3 | 認証なしでステータス変更 | 401 Unauthorized, `AUTHENTICATION_REQUIRED` エラー |
| 2.6.4 | 存在しないフォームIDでのステータス変更 | 404 Not Found, `FORM_NOT_FOUND` エラー |
| 2.6.5 | 他ユーザーのフォームIDでのステータス変更 | 403 Forbidden, `PERMISSION_DENIED` エラー |
| 2.6.6 | isActiveフィールドがないリクエスト | 400 Bad Request, `MISSING_REQUIRED_FIELD` エラー |

### 2.7 フォームの期限設定 (PATCH /forms/{formId}/deadline)

#### 正常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 2.7.1 | 将来の日時での期限設定 | 200 OK, 期限が設定される |
| 2.7.2 | 既存の期限の更新 | 200 OK, 期限が更新される |
| 2.7.3 | 期限の削除（nullを設定） | 200 OK, 期限が削除される |

#### 異常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 2.7.4 | 認証なしで期限設定 | 401 Unauthorized, `AUTHENTICATION_REQUIRED` エラー |
| 2.7.5 | 存在しないフォームIDでの期限設定 | 404 Not Found, `FORM_NOT_FOUND` エラー |
| 2.7.6 | 他ユーザーのフォームIDでの期限設定 | 403 Forbidden, `PERMISSION_DENIED` エラー |
| 2.7.7 | 過去の日時での期限設定 | 400 Bad Request, `INVALID_INPUT` エラー |
| 2.7.8 | 無効な日時形式での期限設定 | 400 Bad Request, `INVALID_INPUT` エラー |

### 2.8 QRコード取得 (GET /forms/{formId}/qrcode)

#### 正常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 2.8.1 | デフォルトサイズでのQRコード取得 | 200 OK, QRコード画像が返却される |
| 2.8.2 | カスタムサイズでのQRコード取得 | 200 OK, 指定サイズのQRコード画像が返却される |

#### 異常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 2.8.3 | 認証なしでQRコード取得 | 401 Unauthorized, `AUTHENTICATION_REQUIRED` エラー |
| 2.8.4 | 存在しないフォームIDでのQRコード取得 | 404 Not Found, `FORM_NOT_FOUND` エラー |
| 2.8.5 | 他ユーザーのフォームIDでのQRコード取得 | 403 Forbidden, `PERMISSION_DENIED` エラー |
| 2.8.6 | 無効なサイズパラメータ（非常に大きい値や負の値） | 400 Bad Request, `INVALID_INPUT` エラー |

## 3. 公開フォームAPI テストケース

### 3.1 公開フォーム取得 (GET /public/forms/{formId})

#### 正常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 3.1.1 | アクティブなフォームIDでの公開フォーム取得 | 200 OK, フォーム情報が返却される |

#### 異常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 3.1.2 | 存在しないフォームIDでの公開フォーム取得 | 404 Not Found, `FORM_NOT_FOUND` エラー |
| 3.1.3 | 非アクティブなフォームIDでの公開フォーム取得 | 404 Not Found, `FORM_NOT_FOUND` エラー または 403 Forbidden, `FORM_INACTIVE` エラー |
| 3.1.4 | 期限切れフォームIDでの公開フォーム取得 | 403 Forbidden, `FORM_EXPIRED` エラー |

### 3.2 フォーム回答送信 (POST /public/forms/{formId}/responses)

#### 正常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 3.2.1 | すべての必須フィールドに回答したデータ送信 | 201 Created, 回答IDが返却される |
| 3.2.2 | 必須フィールドと任意フィールドの混在データ送信 | 201 Created, 回答が保存される |
| 3.2.3 | 選択式要素への有効な回答送信 | 201 Created, 回答が保存される |

#### 異常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 3.2.4 | 存在しないフォームIDへの回答送信 | 404 Not Found, `FORM_NOT_FOUND` エラー |
| 3.2.5 | 非アクティブなフォームへの回答送信 | 403 Forbidden, `FORM_INACTIVE` エラー |
| 3.2.6 | 期限切れフォームへの回答送信 | 403 Forbidden, `FORM_EXPIRED` エラー |
| 3.2.7 | 必須フィールドが欠けているデータ送信 | 400 Bad Request, `MISSING_REQUIRED_FIELD` エラー |
| 3.2.8 | 選択式要素への無効な値の送信 | 400 Bad Request, `INVALID_INPUT` エラー |
| 3.2.9 | 存在しない要素UUIDへの回答送信 | 400 Bad Request, `INVALID_INPUT` エラー |
| 3.2.10 | レート制限を超えた回答送信 | 429 Too Many Requests, `RATE_LIMIT_EXCEEDED` エラー |

## 4. 回答管理 API テストケース

### 4.1 回答一覧取得 (GET /forms/{formId}/responses)

#### 正常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 4.1.1 | すべての回答一覧取得 | 200 OK, 回答一覧が返却される |
| 4.1.2 | ページネーションパラメータ指定での一覧取得 | 200 OK, 指定されたページの回答が返却される |
| 4.1.3 | 日付範囲指定での一覧取得 | 200 OK, 指定範囲内の回答が返却される |
| 4.1.4 | 回答がないフォームの一覧取得 | 200 OK, 空の配列が返却される |

#### 異常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 4.1.5 | 認証なしで回答一覧取得 | 401 Unauthorized, `AUTHENTICATION_REQUIRED` エラー |
| 4.1.6 | 存在しないフォームIDでの回答一覧取得 | 404 Not Found, `FORM_NOT_FOUND` エラー |
| 4.1.7 | 他ユーザーのフォームIDでの回答一覧取得 | 403 Forbidden, `PERMISSION_DENIED` エラー |
| 4.1.8 | 無効な日付形式での範囲指定 | 400 Bad Request, `INVALID_INPUT` エラー |

### 4.2 回答詳細取得 (GET /forms/{formId}/responses/{responseId})

#### 正常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 4.2.1 | 存在する回答IDでの詳細取得 | 200 OK, 回答詳細が返却される |

#### 異常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 4.2.2 | 認証なしで回答詳細取得 | 401 Unauthorized, `AUTHENTICATION_REQUIRED` エラー |
| 4.2.3 | 存在しないフォームIDでの回答詳細取得 | 404 Not Found, `FORM_NOT_FOUND` エラー |
| 4.2.4 | 存在しない回答IDでの詳細取得 | 404 Not Found, `RESPONSE_NOT_FOUND` エラー |
| 4.2.5 | 他ユーザーのフォームに対する回答詳細取得 | 403 Forbidden, `PERMISSION_DENIED` エラー |

### 4.3 回答削除 (DELETE /forms/{formId}/responses/{responseId})

#### 正常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 4.3.1 | 存在する回答IDでの削除 | 200 OK, 回答が削除される |

#### 異常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 4.3.2 | 認証なしで回答削除 | 401 Unauthorized, `AUTHENTICATION_REQUIRED` エラー |
| 4.3.3 | 存在しないフォームIDでの回答削除 | 404 Not Found, `FORM_NOT_FOUND` エラー |
| 4.3.4 | 存在しない回答IDでの削除 | 404 Not Found, `RESPONSE_NOT_FOUND` エラー |
| 4.3.5 | 他ユーザーのフォームに対する回答削除 | 403 Forbidden, `PERMISSION_DENIED` エラー |

### 4.4 回答の統計データ取得 (GET /forms/{formId}/statistics)

#### 正常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 4.4.1 | 回答が存在するフォームの統計取得 | 200 OK, 統計データが返却される |
| 4.4.2 | 回答が存在しないフォームの統計取得 | 200 OK, 空の統計データが返却される |

#### 異常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 4.4.3 | 認証なしで統計データ取得 | 401 Unauthorized, `AUTHENTICATION_REQUIRED` エラー |
| 4.4.4 | 存在しないフォームIDでの統計取得 | 404 Not Found, `FORM_NOT_FOUND` エラー |
| 4.4.5 | 他ユーザーのフォームIDでの統計取得 | 403 Forbidden, `PERMISSION_DENIED` エラー |

### 4.5 回答データCSVエクスポート (GET /forms/{formId}/export)

#### 正常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 4.5.1 | 全フィールドのCSVエクスポート | 200 OK, CSVファイルが返却される |
| 4.5.2 | 特定フィールドのみのCSVエクスポート | 200 OK, 指定フィールドのみのCSVが返却される |
| 4.5.3 | 日付範囲指定でのCSVエクスポート | 200 OK, 指定範囲内の回答のCSVが返却される |
| 4.5.4 | 回答がない場合のCSVエクスポート | 200 OK, ヘッダーのみのCSVが返却される |

#### 異常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 4.5.5 | 認証なしでCSVエクスポート | 401 Unauthorized, `AUTHENTICATION_REQUIRED` エラー |
| 4.5.6 | 存在しないフォームIDでのCSVエクスポート | 404 Not Found, `FORM_NOT_FOUND` エラー |
| 4.5.7 | 他ユーザーのフォームIDでのCSVエクスポート | 403 Forbidden, `PERMISSION_DENIED` エラー |
| 4.5.8 | 存在しない要素UUIDをフィールドに指定 | 400 Bad Request, `INVALID_INPUT` エラー |
| 4.5.9 | 無効な日付形式での範囲指定 | 400 Bad Request, `INVALID_INPUT` エラー |

## 5. ユーザー管理 API テストケース

### 5.1 ユーザー情報取得 (GET /users/me)

#### 正常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 5.1.1 | 認証済みユーザーの情報取得 | 200 OK, ユーザー情報が返却される |

#### 異常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 5.1.2 | 認証なしでユーザー情報取得 | 401 Unauthorized, `AUTHENTICATION_REQUIRED` エラー |
| 5.1.3 | 無効なトークンでユーザー情報取得 | 401 Unauthorized, `INVALID_TOKEN` エラー |

### 5.2 ユーザー情報更新 (PUT /users/me)

#### 正常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 5.2.1 | メールアドレス更新 | 200 OK, ユーザー情報が更新される |

#### 異常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 5.2.2 | 認証なしでユーザー情報更新 | 401 Unauthorized, `AUTHENTICATION_REQUIRED` エラー |
| 5.2.3 | 無効なトークンでユーザー情報更新 | 401 Unauthorized, `INVALID_TOKEN` エラー |
| 5.2.4 | 既に使用されているメールアドレスへの更新 | 400 Bad Request, `DUPLICATE_EMAIL` エラー |
| 5.2.5 | 無効なメールアドレス形式での更新 | 400 Bad Request, `INVALID_INPUT` エラー |

### 5.3 パスワード変更 (PUT /users/me/password)

#### 正常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 5.3.1 | 正しい現在のパスワードと有効な新パスワードでの変更 | 200 OK, パスワードが更新される |

#### 異常系テスト
| No | テスト内容 | 期待結果 |
|---|----------|---------|
| 5.3.2 | 認証なしでパスワード変更 | 401 Unauthorized, `AUTHENTICATION_REQUIRED` エラー |
| 5.3.3 | 無効なトークンでパスワード