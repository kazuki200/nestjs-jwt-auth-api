# シンプルフォーム作成アプリケーション 詳細仕様書

## 1. 概要

シンプルフォーム作成アプリケーションは、ユーザーがカスタムフォームを簡単に作成、共有し、回答を収集・分析できるウェブベースのソリューションです。このアプリケーションはシンプルさと優れたユーザーエクスペリエンスを優先し、1週間以内での迅速なデプロイを目指しています。

## 2. 主要機能

### 2.1 フォーム作成

ユーザーが直感的な操作でカスタムフォームを作成できる機能を提供します。

- **ドラッグ＆ドロップインターフェース**
  - 要素の追加、順序変更、削除が視覚的に行える
  - リアルタイムプレビュー機能

- **サポートする入力タイプ**
  - 短文テキスト入力
  - 長文テキスト入力（段落）
  - 選択式（ラジオボタン）
  - チェックボックス
  - 日付選択
  - 数値入力

- **設定オプション**
  - フォームのタイトルと説明文
  - 必須/任意フィールドの切り替え
  - プレースホルダーテキストの設定
  - 入力欄のラベル設定

### 2.2 フォーム共有

作成したフォームを他のユーザーと共有する機能を提供します。

- **共有オプション**
  - 一意のURL生成（例：`https://example.com/form/abc123`）
  - QRコード生成（モバイルアクセス用）
  - メールでの送信機能

- **プライバシー設定**
  - アクティブ/非アクティブ状態の切り替え
  - 回答期限の設定（オプション）

### 2.3 回答管理

フォームへの回答を収集・分析する機能を提供します。

- **回答の表示**
  - すべての提出内容の一覧表示
  - 個別回答の詳細表示
  - 日付によるフィルタリング

- **データ分析**
  - 選択式質問の基本的なグラフ表示（円グラフ、棒グラフ）
  - 回答数と完了率の統計

- **データエクスポート**
  - CSV形式でのエクスポート
  - 選択したフィールドのみのエクスポートオプション

### 2.4 ユーザー管理

アプリケーションのユーザー管理機能を提供します。

- **認証**
  - メールアドレスとパスワードによるログイン
  - パスワードリセット機能

- **ダッシュボード**
  - 作成したフォーム一覧
  - 各フォームの基本統計（回答数、閲覧数）
  - フォームのステータス管理

## 3. 技術仕様

### 3.1 フロントエンド

- **フレームワーク**
  - React.js

- **UI/UXライブラリ**
  - Tailwind CSS
  - React DnD（ドラッグ＆ドロップ）
  - React Hook Form（フォームハンドリング）

- **その他のライブラリ**
  - Chart.js（データ可視化）
  - QRCode.react（QRコード生成）

- **主要コンポーネント**
  - FormBuilder：フォーム作成インターフェース
  - FormViewer：公開フォーム表示
  - ResponseDashboard：回答データの表示・分析
  - AuthComponents：認証関連コンポーネント

### 3.2 バックエンド

- **サーバーサイド**
  - Node.js with Express

- **データベース**
  - MongoDB（NoSQLデータベース）
  - MongoDBコネクタとしてMongoose

- **認証・認可**
  - JWT（JSON Web Token）
  - bcrypt（パスワードハッシュ化）

- **主要API**
  - ユーザー認証API（`/api/auth/*`）
  - フォーム管理API（`/api/forms/*`）
  - 回答収集API（`/api/responses/*`）

### 3.3 データベーススキーマ

- **Usersコレクション**

```
{
  _id: ObjectId,
  email: String,
  password: String（ハッシュ化）,
  createdAt: Date
}
```

- **Formsコレクション**

```
{
  _id: ObjectId,
  userId: ObjectId,
  title: String,
  description: String,
  elements: [
    {
      uuid: String,
      type: String,
      label: String,
      placeholder: String,
      isRequired: Boolean,
      options: [{ value: String, label: String }], // 選択式要素用
      position: Number
    }
  ],
  isActive: Boolean,
  createdAt: Date,
  updatedAt: Date
}
```

- **Responsesコレクション**

```
{
  _id: ObjectId,
  formId: ObjectId,
  answers: {
    [elementUuid]: String または Array // 回答値
  },
  createdAt: Date
}
```

### 3.4 デプロイメント

- **ホスティング環境**
  - フロントエンド：Vercel
  - バックエンド：Heroku
  - データベース：MongoDB Atlas

- **CI/CD**
  - GitHub Actions

## 4. UI設計

### 4.1 フォームビルダーページ

フォーム作成のためのインターフェースを提供します。

- **レイアウト構成**
  - 左サイドバー：利用可能なフォーム要素タイプのリスト
  - メインエリア：フォームプレビューとドラッグ＆ドロップエリア
  - トップバー：フォームタイトルと説明入力欄
  - ボトムバー：保存、プレビュー、公開ボタン

- **操作フロー**
  1. サイドバーから要素をドラッグしてメインエリアにドロップ
  2. 要素をクリックして詳細設定パネルを表示
  3. フォーム全体の設定（タイトル、説明）を入力
  4. 保存ボタンでフォームを保存
  5. 公開ボタンでフォームをアクティブ化

### 4.2 フォームビューアページ

エンドユーザーがフォームに回答するためのインターフェースを提供します。

- **レイアウト構成**
  - ヘッダー：フォームタイトルと説明
  - メインエリア：フォーム要素の表示
  - フッター：送信ボタン

- **操作フロー**
  1. フォームの各項目に入力
  2. 必須項目の検証
  3. 送信ボタンクリック
  4. 確認ページへのリダイレクト

### 4.3 ダッシュボード

ユーザーのフォーム管理と回答の確認のためのインターフェースを提供します。

- **レイアウト構成**
  - サイドナビゲーション：フォーム一覧、作成ボタン
  - メインエリア：選択したフォームの詳細または回答一覧

- **フォームリスト表示**
  - タイトル
  - 作成日
  - 回答数
  - ステータス（アクティブ/非アクティブ）
  - アクションボタン（表示、編集、共有、削除）

### 4.4 回答ビュー

フォームへの回答データを表示するインターフェースを提供します。

- **レイアウト構成**
  - フィルターエリア：日付範囲、エクスポートボタン
  - メインエリア：回答データ表示
  - データ分析エリア：基本的なチャート

- **表示オプション**
  - 表形式（すべての回答）
  - 個別回答表示
  - 質問ごとの集計表示

## 5. 開発制約

以下の制約の下で開発を行います。

- **機能制約**
  - カスタムテーマなし（基本的なスタイリングのみ）
  - 指定された6つの入力タイプのみをサポート
  - フォーム内の条件付きロジックは実装しない
  - 決済機能の統合なし
  - ユーザーコラボレーション機能なし

- **実装スコープ**
  - 1週間以内でのMVP（Minimum Viable Product）完成
  - モバイルファーストのレスポンシブデザイン
  - 必要最小限のセキュリティ実装（認証、データ検証）

## 6. 将来の拡張計画

MVP後の拡張候補として以下の機能を検討します。

- **フォーム機能拡張**
  - フォームテンプレート機能
  - ファイルアップロードサポート
  - 条件付きロジック（分岐フォーム）
  - カスタムテーマ

- **データ分析機能**
  - 高度な分析ダッシュボード
  - レポート生成機能
  - データエクスポート形式の追加（Excel、PDF）

- **コラボレーション機能**
  - チーム共同編集
  - コメント機能
  - 複数管理者のアクセス権限設定

- **統合機能**
  - 外部サービス連携（Google Sheets、Slack等）
  - API提供
  - フォーム埋め込み機能

## 7. 開発スケジュール

1週間のMVP開発スケジュールを以下のように計画します。

- **1日目**: 環境セットアップ、データベース設計
- **2-3日目**: バックエンドAPI実装
- **4-5日目**: フロントエンド基本機能実装
- **6日目**: フォームビルダーとビューアーの実装
- **7日目**: テスト、バグ修正、デプロイ

## 8. 技術的検討事項

### 8.1 MongoDBとRDBの比較

本アプリケーションではMongoDBを採用していますが、RDBも検討に値する選択肢です。

**MongoDBの利点**
- スキーマレスで柔軟な設計が可能
- フォーム要素を配列として保存でき、取得が容易
- 開発初期段階でのスキーマ変更が容易

**RDBの利点**
- データの整合性が保証される
- 複雑な集計クエリが容易
- トランザクション処理による安全性

**選定理由**
- 開発期間の短さを考慮し、スキーマ柔軟性を重視
- フォーム要素の動的な追加・変更に適している
- 小〜中規模のユーザー数を想定

### 8.2 セキュリティ対策

- **データ保護**
  - パスワードのハッシュ化（bcrypt）
  - JWTの有効期限設定
  - HTTPSの強制

- **入力検証**
  - サーバーサイドでのデータ検証
  - APIエンドポイントの保護
  - レート制限の実装

- **脆弱性対策**
  - XSS対策
  - CSRF対策
  - 入力サニタイズ

## 9. 運用方針

### 9.1 モニタリング

- エラーログの収集と分析
- パフォーマンス監視
- ユーザー行動の分析

### 9.2 バックアップ

- データベースの定期バックアップ
- 障害復旧手順の確立

### 9.3 メンテナンス

- セキュリティアップデート
- パフォーマンス最適化
- 機能追加のためのリリースサイクル

---

本仕様書は、初期バージョン（v0）のシンプルフォーム作成アプリケーション開発のためのガイドラインです。開発過程で発見された要件や制約に応じて適宜更新されます。
